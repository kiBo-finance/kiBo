# Phase 4: Currency & Account Management - タスクリスト

## 優先度: 高

### 1. データベース統合

- [ ] Prismaスキーマの最終確認・調整
- [ ] 実データベースとの接続テスト
- [ ] モックデータからDB連携への移行
- [ ] データベースシード処理の実装

### 2. 口座管理機能

- [ ] 口座一覧表示 (実データベース連携)
- [ ] 口座追加フォーム
- [ ] 口座編集・削除機能
- [ ] 口座残高リアルタイム表示

### 3. カード管理機能

- [ ] クレジット・デビットカード一覧
- [ ] カード追加フォーム
- [ ] カード情報編集・削除
- [ ] 利用限度額管理

### 4. 多通貨対応

- [ ] 為替レートAPI連携 (実装)
- [ ] リアルタイム通貨変換
- [ ] 通貨設定画面
- [ ] 基準通貨変更機能

### 5. Server Actions実装

- [ ] 口座CRUD Server Actions
- [ ] カードCRUD Server Actions
- [ ] 通貨設定 Server Actions
- [ ] バリデーション・エラーハンドリング

## 優先度: 中

### 6. UI/UX改善

- [ ] 口座・カード表示の最適化
- [ ] 残高表示のアニメーション
- [ ] 通貨選択UI改善
- [ ] エラー・成功メッセージ表示

### 7. セキュリティ強化

- [ ] 口座情報暗号化
- [ ] アクセス権限制御
- [ ] 操作ログ記録
- [ ] CSRFトークン実装

## 優先度: 低

### 8. パフォーマンス最適化

- [ ] 画像最適化
- [ ] バンドルサイズ最適化
- [ ] キャッシング戦略
- [ ] Lazy Loading実装

### 9. テスト拡充

- [ ] 口座管理テスト
- [ ] カード管理テスト
- [ ] 通貨変換テスト
- [ ] Server Actionsテスト

## 技術的考慮事項

### データベース設計

- 金額フィールドはDecimal型使用（精度保証）
- 全取引に通貨コード + 為替レート記録
- ユーザー別データ分離（userId外部キー）

### 状態管理

- Jotai atomsでリアルタイム更新
- サーバー状態とクライアント状態の同期
- 楽観的更新（Optimistic Updates）

### API設計

- RESTful Server Actions
- 型安全なZodバリデーション
- エラーハンドリング統一

## 開発環境設定

### 必要なコマンド

```bash
# Docker環境起動
docker-compose up --build

# データベース操作
npm run db:push
npm run db:seed

# 開発サーバー
npm run dev

# テスト実行
npm test

# 品質チェック
npm run lint
npm run type-check
```

### アクセス先

- **アプリ**: http://localhost:3001 (Docker) / http://localhost:3000 (Local)
- **データベース**: localhost:5432
- **Prisma Studio**: npm run db:studio → localhost:5555

## 完了判定基準

Phase 4完了の条件:

1. ✅ 口座・カード管理の完全CRUD機能
2. ✅ 実データベース連携動作
3. ✅ 多通貨対応・為替レート取得
4. ✅ すべてのテストが通過
5. ✅ TypeScript型エラーなし
6. ✅ ビルドプロセス正常
7. ✅ Docker環境での動作確認
